version: '3.8'

services:
  api:
    build:
      context: ./api
    dockerfile: Dockerfile
    ports:
      - "1452:1452"
    environment:
      - ADMIN_PASSWORD=your_admin_password_here
      - DB_PATH=/data/infra.db
    depends_on:
      - db
    networks:
      - infra_net
    volumes:
      - ./data:/data

  admin:
    build:
      context: ./admin
    dockerfile: Dockerfile
    ports:
      - "1453:1453"
    environment:
      - ADMIN_PASSWORD=your_admin_password_here
      - DB_PATH=/data/infra.db
    depends_on:
      - db
    networks:
      - infra_net
    volumes:
      - ./data:/data

  db:
    image: nouchka/sqlite3
    container_name: infra_sqlite
    networks:
      - infra_net
    volumes:
      - ./data:/data

networks:
  infra_net:
    driver: bridge
